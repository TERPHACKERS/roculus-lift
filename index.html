<!DOCTYPE html>
<html>
<head>
<title>Accelerometer</title>
<meta name="viewport" content="width=device-width,user-scalable=yes" />
<style>
body {
	font-family: helvetica, arial, sans serif;
}
</style>
</head>

<body>
<div id="content">
    <h1>Accelerometer Javascript Test</h1>
<ul>
	<li>acceleration x: <span id="accelerationX"></span>g</li>
	<li>acceleration y: <span id="accelerationY"></span>g</li>
	<li>acceleration z: <span id="accelerationZ"></span>g</li>
	<li>rotation alpha: <span id="rotationAlpha"></span>degree</li>
	<li>rotation beta: <span id="rotationBeta"></span>degree</li>
	<li>rotation gamma: <span id="rotationGamma"></span>degree</li>
</ul>

<span id="rep"></span>
<span id="count"></span>

</div>
<script type="text/javascript">

var flag = true;
var count = 0;

var x = 0, y = 0,
    vx = 0, vy = 0,
	ax = 0, ay = 0;

if (window.DeviceMotionEvent != undefined) {
	window.ondevicemotion = function(e) {
		ax = event.accelerationIncludingGravity.x * 5;
		ay = event.accelerationIncludingGravity.y * 5;
    if (e.accelerationIncludingGravity.z < -5) {
      document.getElementById("rep").innerHTML = "down rep";
      flag = true;
    } else if(flag === true && e.accelerationIncludingGravity.z > -3) {
      document.getElementById("rep").innerHTML = "up rep";
      flag = false;
      count += 1;
    }
		document.getElementById("accelerationX").innerHTML = (e.accelerationIncludingGravity.x).toFixed(1);
		document.getElementById("accelerationY").innerHTML = (e.accelerationIncludingGravity.y).toFixed(1);
		document.getElementById("accelerationZ").innerHTML = (e.accelerationIncludingGravity.z).toFixed(1);

    document.getElementById("count").innerHTML = count;

		if ( e.rotationRate ) {
			document.getElementById("rotationAlpha").innerHTML = (e.rotationRate.alpha).toFixed(0);;
			document.getElementById("rotationBeta").innerHTML = (e.rotationRate.beta).toFixed(0);;
			document.getElementById("rotationGamma").innerHTML = (e.rotationRate.gamma).toFixed(0);;
		}
	}

}

</script>

</body>
</html>
